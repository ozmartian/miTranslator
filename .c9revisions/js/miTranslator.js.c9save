{"ts":1372794418182,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var handleOpenURL = function(url) { setTimeout(function() { miTrans.translate(url.substring(10)); }, 0); };\r\n\r\nvar miTrans = {\r\n\r\n    jqXHR: null,\r\n\r\n    service: {\r\n\r\n        baidu: {\r\n            uri: 'http://openapi.baidu.com/public/2.0/bmt/translate?client_id=tdtoPMy8Y2GG0GPYkrWfhSr6&q=',\r\n            query: '&from={from}&to={to}',\r\n            result: 'trans_result[0].dst',\r\n            datatype: 'jsonp',\r\n            type: 'GET',\r\n            lang: { chinese: 'zh', english: 'en' },\r\n            enabled: true\r\n        },\r\n\r\n        bing: {\r\n            uri: 'https://api.microsofttranslator.com/v2/Ajax.svc/Translate?appid=66A8CA727C20371BED579D93DC7E476479EAC832&oncomplete=miTrans.callback&text=',\r\n            query: '&from={from}&to={to}',\r\n            result: '',\r\n            datatype: 'jsonp',\r\n            type: 'GET',\r\n            lang: { chinese: 'zh-CHS', english: 'en' },\r\n            enabled: true\r\n        },\r\n\r\n        systran: {\r\n            uri: 'http://svstxt.systransoft.com/?gui=vgadget&service=translate&loca=ZH',\r\n            query: '&lp={from}_{to}',\r\n            result: '',\r\n            datatype: 'text',\r\n            type: 'POST',\r\n            lang: { chinese: 'zh', english: 'en' },\r\n            enabled: true\r\n        },\r\n\r\n        transcloud: {\r\n            uri: 'http://translation-cloud.com/wp-content/themes/translationcloud/ajax/free_translator.php?text=',\r\n            query: '&src={from}&dst={to}',\r\n            result: '',\r\n            datatype: 'text',\r\n            type: 'GET',\r\n            lang: { chinese: 'zh-CHS', english: 'en' },\r\n            enabled: false\r\n        },\r\n\r\n        youdao: {\r\n            uri: 'http://fanyi.youdao.com/openapi.do?keyfrom=friskfly&key=1410212834&type=data&doctype=jsonp&version=1.1&q=',\r\n            query: '',\r\n            result: 'translation[0]',\r\n            datatype: 'jsonp',\r\n            type: 'GET',\r\n            lang: {},\r\n            enabled: true\r\n        }\r\n\r\n    },\r\n\r\n    isphonegap: false,\r\n    clipdata: '',\r\n    timer: '',\r\n    data: '',\r\n    response: '',\r\n    from: '',\r\n    to: '',\r\n\r\n    provider: 'systran',\r\n\r\n    regex: new RegExp('[^\\x00-\\x80]+'),\r\n\r\n    isJSON: function(val) {\r\n        try {\r\n            JSON.parse(val);\r\n            return true;\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    callback: function(response) {\r\n        miTrans.data = response;\r\n$.dump(response);\r\n        if (document.location.hash === \"#debug\") { console.log('response: ' + data); }\r\n        if (miTrans.service[miTrans.provider].result.length > 0) {\r\n            miTrans.response = eval('miTrans.data.' + miTrans.service[miTrans.provider].result);\r\n        } else {\r\n            miTrans.response = miTrans.data;\r\n        }\r\n        $('#translatedText .iscroll-content').text(miTrans.response);\r\n\r\n        /* BEGIN: REVERSE TRANSLATION */\r\n        var reverseTrans = '<h3>Reverse Translation</h3>';\r\n        /*    END: REVERSE TRANSLATION */\r\n\r\n        $('#translatedText').iscrollview('refresh');\r\n        miTrans.loader(false);\r\n        miTrans.setclip(miTrans.response);\r\n    },\r\n\r\n    ajaxOptions:  function(uri, datatype, type, data){\r\n        return {\r\n            url: uri,\r\n            type: (type != null ? type : \"GET\"),\r\n            data: (data != null ? data : \"\"),\r\n            dataType: datatype,\r\n            cache: false,\r\n            async: true,\r\n            processData: (type == \"POST\" ? false : true),\r\n            jsonpCallback: 'miTrans.callback'\r\n        };\r\n    },\r\n\r\n    translate: function(toTrans) {\r\n        if (toTrans && typeof(toTrans) == 'string' && toTrans.length > 0) { $('#translateText').val(unescape(toTrans)); }\r\n        var text = $('#translateText').val();\r\n        if (text.length > 0) {\r\n            if (miTrans.service[miTrans.provider].query.length > 0) {\r\n                miTrans.from = miTrans.regex.test(text) ? miTrans.service[miTrans.provider].lang.chinese : miTrans.service[miTrans.provider].lang.english;\r\n                miTrans.to = miTrans.regex.test(text) ? miTrans.service[miTrans.provider].lang.chinese : miTrans.service[miTrans.provider].lang.english;\r\n                var qsVal = (miTrans.service[miTrans.provider].query).replace(/{from}/gi, miTrans.from).replace(/{to}/gi, miTrans.to);\r\n                if (miTrans.service[miTrans.provider].type === \"POST\") {\r\n                    var fullURI = miTrans.service[miTrans.provider].uri + qsVal;\r\n                } else {\r\n                    var fullURI = miTrans.service[miTrans.provider].uri + encodeURIComponent(text) + qsVal;\r\n                }\r\n            } else {\r\n                var fullURI = miTrans.service[miTrans.provider].uri + encodeURIComponent(text);\r\n            }\r\n            var data = (miTrans.service[miTrans.provider].type == \"POST\") ? encodeURIComponent(text) : \"\";\r\n            var options = miTrans.ajaxOptions(fullURI, miTrans.service[miTrans.provider].datatype, miTrans.service[miTrans.provider].type, data);\r\n            miTrans.jqXHR = $.ajax(options)\r\n                .done(function(data) { miTrans.callback(data); })\r\n                .fail(function(jqXHR, statusText, error) {\r\n                    miTrans.loader(false);\r\n                    console.log('translate() ERROR: ' + error + ' [' + jqXHR.statusCode + ']');\r\n                    $.dump(jqXHR)\r\n                });\r\n        }\r\n        return false;\r\n    },\r\n    \r\n    /* TODO: replace with Modernizr.load() */\r\n    loadscript: function(script) {\r\n        if ($(\"script[src$='\" + script + \"']\").length == 0) {          \r\n            var tag = document.createElement(\"script\");\r\n            tag.setAttribute('src', script);            \r\n            $(\"head\")[0].appendChild(tag);\r\n        }\r\n        return true;\r\n    },\r\n\r\n    select: function(e, elem) {\r\n        e.preventDefault();\r\n        if ($(elem).val().length > 0) {\r\n            elem.selectionStart = 0;\r\n            elem.selectionEnd = elem.value.length;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    clear: function() {\r\n        $('#translateText').val('');\r\n        $('#translatedText .iscroll-content').empty();\r\n    },\r\n\r\n    setprovider: function(e, p) {\r\n        e.preventDefault();\r\n        if (p) {\r\n            miTrans.provider = $(p).attr('rel');\r\n            $('#provider_image_' + miTrans.provider).attr('src', 'img/providers/' + miTrans.provider + '.png');\r\n        }\r\n        return false;\r\n    },\r\n\r\n    notify: function(msg, elem, autohide) {\r\n        var autohide = (typeof (autohide) == 'undefined') ? true : false;\r\n        if (typeof (msg) == 'string') {\r\n            var elem = ((elem == null || typeof (elem) == 'undefined') && $('#translateText').text().length > 0) ? $(elem) : 'window';\r\n            $('#message').html(msg).popup('open', { transition: 'fade', positionTo: elem });\r\n            if (autohide) { setTimeout(function() { $('#message').popup('close', { transition: 'fade' }); }, 3000); }\r\n        }\r\n    },\r\n\r\n    providers: function() {\r\n        $('#navbar').append('<ul id=\"providers\" data-corners=\"true\"></ul>');\r\n        $.each(miTrans.service, function(provider) {\r\n            if (miTrans.service[provider].enabled) {\r\n                $('#providers').append('<li><a rel=\"' + provider.toLowerCase() + '\" class=\"provider\" data-theme=\"a\"><div id=\"provider_' + provider.toLowerCase() + '\"></div></a></li>');\r\n            }\r\n        });\r\n        $('#navbar').navbar();\r\n        $('#providers a[rel=' + miTrans.provider + ']').addClass('ui-btn-active');\r\n    },\r\n\r\n    events: function() {\r\n        var uriText = $.url(false).param('text');\r\n        if (typeof(uriText) == 'string' && uriText.length > 0) {\r\n            miTrans.translate(uriText);\r\n        }\r\n        $('#translateText')\r\n            .on('blur', function(e) { $.mobile.silentScroll(0); })\r\n            .on('change', function(e) { miTrans.translate(); })\r\n            .on('keydown', function(e) {\r\n                clearTimeout(miTrans.timer);\r\n                if ($(this).val().trim().length == 0) { $(this).val(''); }\r\n            })\r\n            .on('keyup', function(e) {\r\n                clearTimeout(miTrans.timer);\r\n                if (e.keyCode == 13) { miTrans.translate(); }\r\n                else { miTrans.timer = setTimeout(function() { miTrans.translate(); }, 500); }\r\n            })\r\n            .on('click', function(e) { miTrans.select(e, this); });\r\n\r\n        $('#footer a.provider').on('touchstart', function(e) {\r\n            miTrans.setprovider(e, this);\r\n            miTrans.translate();\r\n        });\r\n    },\r\n\r\n    getclip: function() {\r\n        //if (miTrans.isphonegap) {\r\n        try {\r\n            cordova.exec(function(data){\r\n                if ($.trim(data).length > 0) {\r\n                    miTrans.clipdata = $.trim(data);\r\n                    miTrans.translate(miTrans.clipdata);\r\n                }\r\n            }, function(){}, 'ClipboardPlugin', 'getText', []);\r\n        } catch(ex) {\r\n            console.log(ex);\r\n        }\r\n        //}\r\n    },\r\n\r\n    setclip: function(data) {\r\n        //if (miTrans.isphonegap) {\r\n        try {\r\n            if (data && $.trim(data).length > 0) {\r\n                cordova.exec(function(){}, function(){}, 'ClipboardPlugin', 'setText', [data]);\r\n            }\r\n        } catch(ex) {\r\n            console.log(ex);\r\n        }\r\n        //}\r\n    },\r\n\r\n    loader: function(on)  {\r\n        if (on) { $('.loader').fadeIn('fast'); }\r\n        else { $('.loader').fadeOut('slow'); }\r\n    },\r\n    \r\n    defaults: function() {\r\n        $.support.cors = true;\r\n        $.extend($.mobile, { allowCrossDomainPages: true });\r\n    },\r\n\r\n    init: function() {\r\n        miTrans.defaults();\r\n        miTrans.providers();\r\n        miTrans.events();\r\n        $('#page').fadeIn('slow');\r\n        $('#translateText').width($('#content').width()+6);\r\n        $('#content').height($('#content').height()-95);\r\n        setTimeout(function(){ miTrans.getclip(); }, 0);\r\n        //$('#sitefooter').remove();\r\n    }\r\n\r\n};\r\n\r\n$(document)\r\n    .on('touchmove', function(e) { e.preventDefault(); })\r\n    .on('pageinit', function(e) { miTrans.init(); });"]],"start1":0,"start2":0,"length1":0,"length2":10081}]],"length":10081}
{"ts":1372794424636,"patch":[[{"diffs":[[0,"e;\r\n"],[-1,"$.dump(response);\r\n"],[0,"    "]],"start1":2398,"start2":2398,"length1":27,"length2":8}]],"length":10062,"saved":false}
{"ts":1372794464781,"patch":[[{"diffs":[[0,"toTrans) {\r\n"],[1,"        miTrans.\r\n"],[0,"        if ("]],"start1":3523,"start2":3523,"length1":24,"length2":42}]],"length":10080,"saved":false}
{"ts":1372794467442,"patch":[[{"diffs":[[0,"miTrans."],[1,"loader(true);"],[0,"\r\n      "]],"start1":3543,"start2":3543,"length1":16,"length2":29}]],"length":10093,"saved":false}
{"ts":1372794768412,"patch":[[{"diffs":[[0,".lang.english;\r\n"],[1,"                \r\n"],[0,"                "]],"start1":3979,"start2":3979,"length1":32,"length2":50}]],"length":10111,"saved":false}
{"ts":1372794772541,"patch":[[{"diffs":[[0,"                "],[1,"if "],[0,"\r\n              "]],"start1":3995,"start2":3995,"length1":32,"length2":35}]],"length":10114,"saved":false}
{"ts":1372794776970,"patch":[[{"diffs":[[0,"     if "],[1,"(miTrans.f)"],[0,"\r\n      "]],"start1":4006,"start2":4006,"length1":16,"length2":27}]],"length":10125,"saved":false}
{"ts":1372794778294,"patch":[[{"diffs":[[0,"iTrans.f"],[1,"rom"],[0,")\r\n     "]],"start1":4016,"start2":4016,"length1":16,"length2":19}]],"length":10128,"saved":false}
{"ts":1372794781488,"patch":[[{"diffs":[[0,"ans.from"],[1," == "],[0,")\r\n     "]],"start1":4019,"start2":4019,"length1":16,"length2":20}]],"length":10132,"saved":false}
{"ts":1372794782317,"patch":[[{"diffs":[[0,"from == "],[1,"\"\""],[0,")\r\n     "]],"start1":4023,"start2":4023,"length1":16,"length2":18}]],"length":10134,"saved":false}
{"ts":1372794839060,"patch":[[{"diffs":[[0,"    "],[-1,"miTrans.from = "],[1,"if ("],[0,"miTr"]],"start1":3851,"start2":3851,"length1":23,"length2":12},{"diffs":[[0,"regex.test(text)"],[-1," ?"],[1,") {\r\n                    miTrans.from ="],[0," miTrans.service"]],"start1":3867,"start2":3867,"length1":34,"length2":71},{"diffs":[[0,"er].lang.chinese"],[-1," :"],[1,";\r\n                    miTrans.to ="],[0," miTrans.service"]],"start1":3953,"start2":3953,"length1":34,"length2":67},{"diffs":[[0,"    "],[-1,"if (miTrans.from == \"\")\r\n                miTrans.to = miTrans.regex.test(text) ? miTrans.service[miTrans.provider].lang.chinese : miTrans.service[miTrans.provider].lang.english;"],[1,"    //$('#translatedText').removeClass('chinese').addClass('english');\r\n                } else {\r\n                    miTrans.from = miTrans.service[miTrans.provider].lang.english;\r\n                    miTrans.to = miTrans.service[miTrans.provider].lang.chinese;\r\n                    //$('#translatedText').removeClass('english').addClass('chinese');\r\n                }"],[0,"\r\n  "]],"start1":4066,"start2":4066,"length1":185,"length2":377}]],"length":10385,"saved":false}
{"ts":1372794842774,"patch":[[{"diffs":[[0,"e;\r\n"],[-1,"                    //$('#translatedText').removeClass('english').addClass('chinese');\r\n"],[0,"    "]],"start1":4330,"start2":4330,"length1":96,"length2":8}]],"length":10297,"saved":false}
{"ts":1372794844331,"patch":[[{"diffs":[[0,"h;\r\n"],[-1,"                    //$('#translatedText').removeClass('chinese').addClass('english');\r\n"],[0,"    "]],"start1":4050,"start2":4050,"length1":96,"length2":8}]],"length":10209,"saved":false}
{"ts":1372795045058,"patch":[[{"diffs":[[0,".lang.english;\r\n"],[1,"                    //$('#translatedText').removeClass('chinese').addClass('english');\r\n"],[0,"                "]],"start1":4038,"start2":4038,"length1":32,"length2":120}]],"length":10297,"saved":false}
{"ts":1372795046573,"patch":[[{"diffs":[[0,"h;\r\n"],[-1,"                    //$('#translatedText').removeClass('chinese').addClass('english');\r\n"],[0,"    "]],"start1":4050,"start2":4050,"length1":96,"length2":8}]],"length":10209,"saved":false}
{"ts":1372795280170,"patch":[[{"diffs":[[0,"').text("],[1,"unescape("],[0,"miTrans."]],"start1":2774,"start2":2774,"length1":16,"length2":25}]],"length":10218,"saved":false}
{"ts":1372795281458,"patch":[[{"diffs":[[0,"esponse)"],[1,")"],[0,";\r\n\r\n   "]],"start1":2800,"start2":2800,"length1":16,"length2":17}]],"length":10219,"saved":false}
{"ts":1372795421289,"patch":[[{"diffs":[[0,"').text("],[-1,"unescape"],[1,"decodeURI"],[0,"(miTrans"]],"start1":2774,"start2":2774,"length1":24,"length2":25}]],"length":10220,"saved":false}
{"ts":1372795423847,"patch":[[{"diffs":[[0,"ecodeURI"],[1,"Component"],[0,"(miTrans"]],"start1":2783,"start2":2783,"length1":16,"length2":25}]],"length":10229,"saved":false}
{"ts":1372795522698,"patch":[[{"diffs":[[0,");\r\n"],[-1,"\r\n        /* BEGIN: REVERSE TRANSLATION */\r\n        var reverseTrans = '<h3>Reverse Translation</h3>';\r\n        /*    END: REVERSE TRANSLATION */\r\n\r\n"],[0,"    "]],"start1":2818,"start2":2818,"length1":157,"length2":8}]],"length":10080,"saved":false}
